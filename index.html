<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal Diamond - Bot Master</title>
    <script src='//libtl.com/sdk.js' data-zone='10343752' data-sdk='show_10343752'></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap');
        body { background: radial-gradient(circle, #1e3a8a 0%, #0f172a 100%); color: white; font-family: 'Poppins', sans-serif; min-height: 100vh; padding-bottom: 90px; }
        .tab-content { display: none; width: 100%; max-width: 420px; margin: auto; padding: 15px; animation: fadeIn 0.4s; }
        .active-tab { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .glass-card { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 20px; }
        .top-icons { position: fixed; top: 20px; right: 15px; display: flex; flex-direction: column; gap: 12px; z-index: 1000; }
        .float-btn { width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; border: 2px solid rgba(255,255,255,0.2); backdrop-filter: blur(10px); box-shadow: 0 4px 15px rgba(0,0,0,0.3); transition: 0.3s; cursor: pointer; }
        .spin-float { background: linear-gradient(45deg, #fbbf24, #d97706); animation: iconSpin 12s linear infinite; }
        .shop-float { background: linear-gradient(45deg, #3b82f6, #1d4ed8); }
        @keyframes iconSpin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .level-row { display: grid; grid-template-columns: 1fr 2fr 2fr; padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 10px; }
        .level-row.current { background: rgba(251, 191, 36, 0.2); border-radius: 8px; border: 1px solid #fbbf24; color: #fbbf24; font-weight: bold; }
        .nav-bar { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(15, 23, 42, 0.95); display: flex; justify-content: space-around; padding: 12px; border-top: 1px solid rgba(255,255,255,0.1); z-index: 500; }
        .nav-item { font-size: 10px; color: #94a3b8; text-align: center; flex: 1; cursor: pointer; }
        .nav-item.active { color: #fbbf24; font-weight: bold; }
        #ad-modal { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.98); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 2000; }
    </style>
</head>
<body>

<div id="ad-modal">
    <div class="text-center">
        <div class="w-12 h-12 border-4 border-yellow-500 border-t-transparent rounded-full animate-spin mx-auto mb-3"></div>
        <p class="text-yellow-500 font-bold uppercase text-[10px]">Processing...</p>
    </div>
</div>

<div class="top-icons">
    <div onclick="switchTab('spin-tab')" class="float-btn spin-float">ğŸ¡</div>
    <div onclick="switchTab('shop-tab')" class="float-btn shop-float">ğŸ›’</div>
</div>

<div class="text-center mt-10">
    <h1 class="text-2xl font-black text-transparent bg-clip-text bg-gradient-to-b from-yellow-300 to-yellow-600 italic">ROYAL DIAMOND</h1>
</div>

<div id="home-tab" class="tab-content active-tab">
    <div class="glass-card text-center mb-4">
        <p class="text-gray-400 text-[10px] uppercase">Main Balance</p>
        <p class="text-3xl font-black text-yellow-500">ğŸ’ <span id="home-balance">0</span></p>
    </div>
    
    <div class="glass-card border-t-4 border-yellow-500 mb-4">
        <div class="flex justify-between items-center mb-4">
            <span class="text-yellow-500 font-black text-xs italic">ACTIVE BOT LVL: <span id="display-level">1</span></span>
            <span id="bot-status" class="text-[9px] bg-red-600 px-2 py-0.5 rounded text-white font-bold">OFFLINE</span>
        </div>
        <div class="bg-black/40 p-5 rounded-xl mb-4">
            <div class="flex justify-between text-[10px] mb-2 text-gray-400">
                <span>Timer: <span id="mine-timer">02:30:00</span></span>
                <span id="mine-percent">0%</span>
            </div>
            <div class="w-full bg-gray-700 h-2 rounded-full overflow-hidden">
                <div id="mine-progress-bar" class="bg-yellow-500 h-full w-0"></div>
            </div>
            <p class="text-center mt-3 text-2xl font-black text-green-400"><span id="auto-mined-val">0.00</span> ğŸ’</p>
        </div>
        
        <div class="grid grid-cols-2 gap-3 mb-4">
            <button id="btn-start" onclick="handleAction('start_auto_mine')" class="py-3 rounded-xl font-bold text-xs uppercase shadow-lg">Start</button>
            <button id="btn-claim" onclick="handleAction('claim_auto_mine')" class="py-3 rounded-xl font-bold text-xs uppercase shadow-lg">Claim</button>
        </div>
        
        <button id="btn-upgrade" onclick="handleAction('upgrade_bot')" class="w-full py-4 rounded-xl font-black text-[10px] uppercase flex justify-between px-6 transition-all duration-300">
            <span>Upgrade Bot</span>
            <span id="upgrade-cost-text">100 ğŸ’</span>
        </button>
    </div>

    <div class="glass-card">
        <h3 class="text-yellow-500 font-black text-xs mb-4 uppercase italic">Bot Level History</h3>
        <div id="level-list-container" class="max-height-[300px] overflow-y-auto" style="max-height: 300px;"></div>
    </div>
</div>

<div id="spin-tab" class="tab-content text-center">
    <div class="glass-card">
        <h2 class="text-yellow-500 font-black mb-2 uppercase italic">Lucky Wheel</h2>
        <p class="text-[10px] text-gray-400 mb-4">Cost: 100,000 ğŸ’ per spin</p>
        <div style="position: relative; width: 280px; height: 280px; margin: auto;">
            <div style="position: absolute; top: -15px; left: 50%; transform: translateX(-50%); z-index: 20; font-size: 30px; color: #ff0000;">â–¼</div>
            <canvas id="wheel-canvas" style="width: 100%; height: 100%; border-radius: 50%; border: 6px solid #fbbf24; transition: transform 6s cubic-bezier(0.1, 0, 0, 1);"></canvas>
        </div>
        <button onclick="handleAction('spin')" id="spin-btn" class="mt-8 bg-yellow-500 text-black font-black py-4 px-12 rounded-full uppercase shadow-xl">SPIN NOW</button>
    </div>
</div>

<div id="tasks-tab" class="tab-content"><h2 class="text-center py-10 font-bold">Tasks Coming Soon</h2></div>
<div id="leader-tab" class="tab-content"><h2 class="text-center py-10 font-bold italic uppercase">Top 10 Player</h2><div id="leader-list"></div></div>
<div id="refer-tab" class="tab-content text-center"><div class="glass-card"><h2 class="text-yellow-500 font-bold mb-4">Refer Friends</h2><p id="ref-link" class="text-[9px] mb-4 text-gray-500 truncate">Loading...</p><button onclick="copyRef()" class="bg-yellow-500 text-black px-8 py-2 rounded-lg font-bold text-xs uppercase">Copy</button></div></div>
<div id="wallet-tab" class="tab-content"><div class="glass-card text-center py-10">ğŸ’³<br>Withdraw Coming Soon</div></div>

<nav class="nav-bar">
    <div onclick="switchTab('home-tab', this)" class="nav-item active">ğŸ <br>Home</div>
    <div onclick="switchTab('tasks-tab', this)" class="nav-item">ğŸ“<br>Tasks</div>
    <div onclick="switchTab('leader-tab', this)" class="nav-item">ğŸ†<br>Board</div>
    <div onclick="switchTab('refer-tab', this)" class="nav-item">ğŸ‘¥<br>Refer</div>
    <div onclick="switchTab('wallet-tab', this)" class="nav-item">ğŸ’³<br>Wallet</div>
</nav>

<script>
const firebaseConfig = { apiKey: "AIzaSyA-2VRyhIktuhWesvHRa2LkqAL3g_fDU0", authDomain: "royaldiamondbot.firebaseapp.com", databaseURL: "https://royaldiamondbot-default-rtdb.firebaseio.com", projectId: "royaldiamondbot", storageBucket: "royaldiamondbot.firebasestorage.app", messagingSenderId: "156914195366", appId: "1:156914195366:web:e5ab56df62ecbf90550d67" };
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let userId = localStorage.getItem('user_uid') || "User_" + Math.floor(Math.random() * 89999 + 10000);
localStorage.setItem('user_uid', userId);
const referralLink = "https://t.me/Referralincamebd01311_bot?start=" + userId;

let bal = 0; let botLevel = 1; let autoMineStart = 0;

db.ref('users/' + userId).on('value', snap => {
    const data = snap.val() || {};
    bal = Number(data.balance) || 0; 
    botLevel = Number(data.botLevel) || 1; 
    autoMineStart = Number(data.autoMineStart) || 0;
    document.getElementById('home-balance').innerText = Math.floor(bal).toLocaleString();
    document.getElementById('display-level').innerText = botLevel;
    document.getElementById('upgrade-cost-text').innerText = (100 * Math.pow(2, botLevel - 1)).toLocaleString() + " ğŸ’";
    document.getElementById('ref-link').innerText = referralLink;
    generateLevelChart(botLevel);
});

function generateLevelChart(currentLvl) {
    let html = '';
    for(let i=1; i<=25; i++) {
        let income = i * 2000;
        let cost = 100 * Math.pow(2, i-1);
        let activeClass = (i === currentLvl) ? 'current' : '';
        html += `<div class="level-row ${activeClass}"><span>LVL ${i}</span><span>${income} ğŸ’</span><span>${(i === 25 ? 'MAX' : cost)}</span></div>`;
    }
    document.getElementById('level-list-container').innerHTML = html;
}

function switchTab(id, el) {
    document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active-tab'));
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    document.getElementById(id).classList.add('active-tab');
    if(el) el.classList.add('active');
}

function handleAction(type) {
    if(type === 'spin' && bal < 100000) { alert("à¦¦à¦¾à¦¦à§, à¦¸à§à¦ªà¦¿à¦¨ à¦•à¦°à¦¤à§‡ à§§,à§¦à§¦,à§¦à§¦à§¦ à¦¡à¦¾à¦¯à¦¼à¦®à¦¨à§à¦¡ à¦²à¦¾à¦—à¦¬à§‡!"); return; }
    if(type === 'upgrade_bot') {
        let cost = 100 * Math.pow(2, botLevel - 1);
        if(bal < cost) { alert("à¦ªà¦°à§à¦¯à¦¾à¦ªà§à¦¤ à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸ à¦¨à§‡à¦‡!"); return; }
    }
    document.getElementById('ad-modal').style.display = 'flex';
    if (typeof show_10343752 === 'function') {
        show_10343752().then(() => executeLogic(type)).catch(() => executeLogic(type));
    } else { setTimeout(() => executeLogic(type), 1500); }
}

function executeLogic(type) {
    document.getElementById('ad-modal').style.display = 'none';
    if(type === 'start_auto_mine') db.ref('users/' + userId).update({ autoMineStart: Math.floor(Date.now() / 1000) });
    if(type === 'claim_auto_mine') {
        const reward = botLevel * 2000;
        db.ref('users/' + userId).update({ balance: bal + reward, autoMineStart: 0 });
    }
    if(type === 'upgrade_bot') {
        let cost = 100 * Math.pow(2, botLevel - 1);
        db.ref('users/' + userId).update({ balance: bal - cost, botLevel: botLevel + 1 });
    }
    if(type === 'spin') startSpin();
}

// à§§à§®à¦Ÿà¦¿ à¦˜à¦°à§‡à¦° à¦¸à§à¦ªà¦¿à¦¨ à¦²à¦œà¦¿à¦• (à¦¦à¦¾à¦¦à§à¦° à¦«à¦°à§à¦®à§à¦²à¦¾)
const canvas = document.getElementById('wheel-canvas');
const ctx = canvas.getContext('2d');
canvas.width = 300; canvas.height = 300;

// à§¯à¦Ÿà¦¿ à¦¡à¦¾à¦¯à¦¼à¦®à¦¨à§à¦¡ à¦˜à¦° (à¦¹à¦²à§à¦¦) + à§¯à¦Ÿà¦¿ USDT à¦˜à¦° (à¦¨à§€à¦²)
const prizes = [
    "100000 ğŸ’", "0.10 USDT", "90000 ğŸ’", "10 USDT", 
    "80000 ğŸ’", "0.05 USDT", "70000 ğŸ’", "0.50 USDT", 
    "60000 ğŸ’", "5 USDT", "50000 ğŸ’", "0.20 USDT", 
    "400000 ğŸ’", "0.15 USDT", "300000 ğŸ’", "0.80 USDT", 
    "200000 ğŸ’", "0.01 USDT"
];

function drawWheel() {
    const arc = (2 * Math.PI) / 18;
    for (let i = 0; i < 18; i++) {
        ctx.fillStyle = (i % 2 === 0) ? "#fbbf24" : "#3b82f6";
        ctx.beginPath(); ctx.moveTo(150, 150); ctx.arc(150, 150, 150, i * arc, (i + 1) * arc); ctx.fill();
        ctx.save();
        ctx.fillStyle = (i % 2 === 0) ? "black" : "white";
        ctx.font = "bold 9px Arial";
        ctx.translate(150 + Math.cos(i * arc + arc/2) * 110, 150 + Math.sin(i * arc + arc/2) * 110);
        ctx.rotate(i * arc + arc/2 + Math.PI/2);
        let txt = prizes[i].split(" ")[0];
        ctx.fillText(txt, -ctx.measureText(txt).width/2, 0);
        ctx.restore();
    }
} drawWheel();

let currRot = 0;
function startSpin() {
    // à¦¸à§à¦ªà¦¿à¦¨ à¦«à¦¿ à¦•à¦¾à¦Ÿà¦¾
    db.ref('users/' + userId).update({ balance: bal - 100000 });
    
    const extra = Math.floor(Math.random() * 360) + 3600;
    currRot += extra;
    canvas.style.transform = `rotate(${currRot}deg)`;
    
    setTimeout(() => {
        const actualDeg = currRot % 360;
        let pIdx = Math.floor((360 - actualDeg) / (360 / 18)) % 18;
        
        // à¦¦à¦¾à¦¦à§à¦° à¦²à¦œà¦¿à¦•: à§§à§¦ à¦¬à¦¾ à§« à¦¡à¦²à¦¾à¦°à§‡ à¦ªà§œà¦²à§‡ à¦¸à§‡à¦Ÿà¦¾ à¦¡à¦¾à¦¯à¦¼à¦®à¦¨à§à¦¡à§‡ à¦•à¦¨à¦­à¦¾à¦°à§à¦Ÿ à¦¹à¦¬à§‡ (à¦…à¦«à¦¶à¦¨à¦¾à¦²)
        if (pIdx === 3) pIdx = 2; // à§§à§¦ USDT à¦ªà§œà¦²à§‡ à§¯à§¦à¦¹à¦¾à¦œà¦¾à¦° à¦¡à¦¾à¦¯à¦¼à¦®à¦¨à§à¦¡ à¦ªà¦¾à¦¬à§‡
        if (pIdx === 9) pIdx = 8; // à§« USDT à¦ªà§œà¦²à§‡ à§¬à§¦à¦¹à¦¾à¦œà¦¾à¦° à¦¡à¦¾à¦¯à¦¼à¦®à¦¨à§à¦¡ à¦ªà¦¾à¦¬à§‡
        
        const won = prizes[pIdx];
        if (won.includes("ğŸ’")) {
            let amt = parseInt(won);
            db.ref('users/' + userId).update({ balance: (bal - 100000) + amt });
            alert(`à¦¦à¦¾à¦¦à§, à¦†à¦ªà¦¨à¦¿ à¦œà¦¿à¦¤à¦²à§‡à¦¨ ${amt} ğŸ’!`);
        } else {
            alert(`à¦¦à¦¾à¦¦à§, à¦†à¦ªà¦¨à¦¿ à¦œà¦¿à¦¤à¦²à§‡à¦¨ ${won}! (USDT Balance Updated)`);
        }
    }, 6000);
}

// à¦¬à¦¾à¦Ÿà¦¨ à¦¸à§à¦Ÿà§à¦¯à¦¾à¦Ÿà¦¾à¦¸ à¦•à¦¨à§à¦Ÿà§à¦°à§‹à¦² à¦‡à¦¨à§à¦Ÿà¦¾à¦°à¦­à§à¦¯à¦¾à¦²
setInterval(() => {
    const startBtn = document.getElementById('btn-start');
    const claimBtn = document.getElementById('btn-claim');
    const upgradeBtn = document.getElementById('btn-upgrade');

    // à¦†à¦ªà¦¡à§‡à¦Ÿ à¦¬à¦¾à¦Ÿà¦¨ à¦²à¦œà¦¿à¦•
    let cost = 100 * Math.pow(2, botLevel - 1);
    if (bal < cost || botLevel >= 25) {
        upgradeBtn.disabled = true;
        upgradeBtn.className = "w-full bg-gray-700 text-gray-500 py-4 rounded-xl font-black text-[10px] uppercase flex justify-between px-6 opacity-50 cursor-not-allowed";
    } else {
        upgradeBtn.disabled = false;
        upgradeBtn.className = "w-full bg-yellow-500 text-black py-4 rounded-xl font-black text-[10px] uppercase flex justify-between px-6 shadow-lg";
    }

    if (autoMineStart === 0) {
        startBtn.disabled = false; claimBtn.disabled = true;
        startBtn.className = "bg-blue-600 py-3 rounded-xl font-bold text-xs uppercase shadow-lg text-white";
        claimBtn.className = "bg-gray-700 py-3 rounded-xl font-bold text-xs uppercase shadow-lg text-gray-400 opacity-50";
        return;
    }
    const elapsed = Math.floor(Date.now() / 1000) - autoMineStart;
    const duration = 9000;
    if (elapsed < duration) {
        startBtn.disabled = true; claimBtn.disabled = true;
        startBtn.className = "bg-gray-700 py-3 rounded-xl font-bold text-xs uppercase shadow-lg text-gray-400 opacity-50";
        claimBtn.className = "bg-gray-700 py-3 rounded-xl font-bold text-xs uppercase shadow-lg text-gray-400 opacity-50";
        const timeLeft = duration - elapsed;
        const h = Math.floor(timeLeft / 3600).toString().padStart(2, '0');
        const m = Math.floor((timeLeft % 3600) / 60).toString().padStart(2, '0');
        const s = (timeLeft % 60).toString().padStart(2, '0');
        document.getElementById('mine-timer').innerText = `${h}:${m}:${s}`;
        document.getElementById('mine-progress-bar').style.width = (elapsed/duration*100) + "%";
        document.getElementById('mine-percent').innerText = Math.floor(elapsed/duration*100) + "%";
        document.getElementById('auto-mined-val').innerText = ((elapsed/duration)*(botLevel*2000)).toFixed(2);
    } else {
        startBtn.disabled = true; claimBtn.disabled = false;
        startBtn.className = "bg-gray-700 py-3 rounded-xl font-bold text-xs uppercase shadow-lg text-gray-400 opacity-50";
        claimBtn.className = "bg-green-600 py-3 rounded-xl font-bold text-xs uppercase shadow-lg text-white animate-pulse";
    }
}, 1000);

function copyRef() {
    const link = document.getElementById('ref-link').innerText;
    navigator.clipboard.writeText(link).then(() => alert("Referral link copied!"));
}
</script>
</body>
    </html>
    
