<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Money Fishing - Pro Diamond System</title>
    <style>
        :root { --ui-cyan: #00f2ff; --ui-gold: #ffd700; --ui-pink: #ff00ff; }
        body { margin: 0; padding: 0; background: #001219; overflow: hidden; touch-action: none; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; }

        /* UI Top Bar */
        #ui-top-bar {
            position: absolute; top: 15px; width: 100%;
            display: flex; justify-content: space-between; padding: 0 10px; box-sizing: border-box; z-index: 100;
        }
        .ui-box {
            background: rgba(0, 40, 60, 0.7); backdrop-filter: blur(8px);
            border: 1.5px solid var(--ui-cyan); box-shadow: 0 0 10px rgba(0, 242, 255, 0.4);
            padding: 6px 12px; border-radius: 30px; color: white; font-weight: 700;
            display: flex; align-items: center; gap: 6px; font-size: 11px;
        }
        .diamond-box { border-color: var(--ui-pink); box-shadow: 0 0 10px rgba(255, 0, 255, 0.4); }
        .energy-bar-bg { background: rgba(255,255,255,0.2); width: 40px; height: 7px; border-radius: 5px; overflow: hidden; }
        .energy-fill { background: var(--ui-gold); height: 100%; transition: width 0.3s; }

        /* Bottom Buttons */
        #btn-container { position: absolute; bottom: 30px; width: 100%; display: flex; justify-content: center; gap: 8px; z-index: 20; flex-wrap: wrap; }
        .btn-pro {
            padding: 10px 15px; border-radius: 12px; font-weight: bold; cursor: pointer;
            border: none; color: white; text-transform: uppercase; font-size: 9px;
        }

        /* Modals */
        .modal {
            display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: linear-gradient(180deg, rgba(0, 50, 80, 0.98), rgba(0, 10, 20, 1));
            width: 85%; max-width: 320px; border-radius: 20px; padding: 20px; 
            text-align: center; color: white; z-index: 500; border: 2px solid var(--ui-cyan);
            box-shadow: 0 0 40px rgba(0, 242, 255, 0.3);
        }
        .diamond-modal { border-color: var(--ui-pink); box-shadow: 0 0 40px rgba(255, 0, 255, 0.3); }

        .slot-card {
            background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 12px;
            margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;
            border: 1px solid rgba(255, 0, 255, 0.2);
        }
        .btn-watch { background: var(--ui-pink); color: white; border: none; padding: 7px 10px; border-radius: 8px; font-size: 9px; font-weight: bold; cursor: pointer; }
        .btn-locked { background: #444 !important; cursor: not-allowed; }

        .pro-table { width: 100%; border-collapse: collapse; margin: 12px 0; background: rgba(0,0,0,0.3); font-size: 11px; }
        .pro-table th { background: var(--ui-cyan); color: #000; padding: 8px; }
        .pro-table td { padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.05); }

        /* Ad Overlay */
        #ad-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: black; z-index: 1000; color: white; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
        }
        #ad-progress-container { width: 200px; height: 10px; background: #333; border-radius: 5px; margin-top: 15px; }
        #ad-progress { width: 0%; height: 100%; background: var(--ui-cyan); border-radius: 5px; }
    </style>
</head>
<body>

    <div id="ui-top-bar">
        <div class="ui-box">üí∞ Bal: <span id="coins" style="color:var(--ui-gold)">0.000000</span></div>
        <div class="ui-box diamond-box">üíé <span id="diamonds" style="color:var(--ui-pink)">0</span></div>
        <div class="ui-box">‚ö° <div class="energy-bar-bg"><div id="energy-fill" class="energy-fill" style="width: 100%;"></div></div> <span id="energy-text">5/5</span></div>
    </div>
    
    <div id="btn-container">
        <button class="btn-pro" style="background: #ff4757;" onclick="openShop()">üõçÔ∏è SHOP</button>
        <button class="btn-pro" style="background: #a55eea;" onclick="toggleMenu('diamondMenu', true)">üíé FREE DIAMOND</button>
        <button class="btn-pro" style="background: rgba(0,242,255,0.2); border: 1px solid var(--ui-cyan);">üí∏ WITHDRAW</button>
    </div>

    <div id="shopMenu" class="modal">
        <h3 style="margin: 0; color: var(--ui-cyan);">Shop</h3>
        <table class="pro-table">
            <thead><tr><th>Lv</th><th>Fish</th><th>Cost</th><th>Depth</th></tr></thead>
            <tbody id="shopBody"></tbody>
        </table>
        <button class="btn-pro" style="background: var(--ui-cyan); color: #000; width: 100%;" onclick="doUpgrade()">UPGRADE</button>
        <button class="btn-pro" style="background: transparent; border: 1px solid white; margin-top: 10px; width: 100%;" onclick="toggleMenu('shopMenu', false)">CLOSE</button>
    </div>

    <div id="diamondMenu" class="modal diamond-modal">
        <h3 style="margin-top:0; color:var(--ui-pink)">Free Diamonds</h3>
        <div class="slot-card">
            <div style="text-align:left">
                <span style="font-size:12px; color:var(--ui-pink)">Slot 01</span><br>
                <span style="font-size:9px; opacity:0.7">Daily: <span id="count-1">10</span>/10</span>
            </div>
            <button id="btn-slot-1" class="btn-watch" onclick="startAd('diamond', 1)">WATCH</button>
        </div>
        <div class="slot-card">
            <div style="text-align:left">
                <span style="font-size:12px; color:var(--ui-pink)">Slot 02</span><br>
                <span style="font-size:9px; opacity:0.7">Daily: <span id="count-2">10</span>/10</span>
            </div>
            <button id="btn-slot-2" class="btn-watch" onclick="startAd('diamond', 2)">WATCH</button>
        </div>
        <div class="slot-card">
            <div style="text-align:left">
                <span style="font-size:12px; color:var(--ui-pink)">Slot 03</span><br>
                <span style="font-size:9px; opacity:0.7">Daily: <span id="count-3">10</span>/10</span>
            </div>
            <button id="btn-slot-3" class="btn-watch" onclick="startAd('diamond', 3)">WATCH</button>
        </div>
        <button class="btn-pro" style="background:transparent; border:1px solid white; width:100%; margin-top:5px" onclick="toggleMenu('diamondMenu', false)">CLOSE</button>
    </div>

    <div id="adNeeded" class="modal">
        <h2 style="color: var(--ui-gold);">Out of Energy!</h2>
        <p style="font-size: 12px; opacity: 0.8;">Watch a short ad to get 5 more!</p>
        <button class="btn-pro" style="background: #2ecc71; width: 100%; margin-top: 10px;" onclick="startAd('energy')">üì∫ WATCH AD</button>
    </div>

    <div id="ad-overlay">
        <h2 id="ad-type-title">üé¨ Advertisement</h2>
        <p>Rewarding in <span id="ad-timer">5</span>...</p>
        <div id="ad-progress-container"><div id="ad-progress"></div></div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let totalBalance = 0, diamonds = 0, currentLevel = 1, energy = 5, gameTime = 0;
        const levelCosts = [0, 3, 4, 5, 6];
        let adSlots = { 1: {watched:0, limit:10}, 2: {watched:0, limit:10}, 3: {watched:0, limit:10} };
        
        let hook = { x: canvas.width / 2, y: 100, speed: 6, state: 'idle', maxDepth: 2000 };
        let fishes = [], reefAssets = [];

        function initReef() {
            reefAssets = [];
            for(let i=0; i<40; i++) {
                reefAssets.push({ x: Math.random() * canvas.width, y: Math.random() * 10000 + 400, type: Math.floor(Math.random() * 2), color: ["#ff7f50", "#2ecc71", "#95a5a6"][Math.floor(Math.random() * 3)], size: Math.random() * 20 + 15 });
            }
        }
        initReef();

        function toggleMenu(id, show) { document.getElementById(id).style.display = show ? "block" : "none"; }
        function openShop() { generateShop(); toggleMenu('shopMenu', true); }

        function generateShop() {
            const tbody = document.getElementById("shopBody");
            tbody.innerHTML = "";
            for (let i = 1; i <= 5; i++) {
                let row = document.createElement("tr");
                if(i === currentLevel) row.style.background = "rgba(0, 242, 255, 0.2)";
                row.innerHTML = `<td>${i}</td><td>${i*4}</td><td>${i==1?'Free':'$'+levelCosts[i-1]}</td><td>${i*2000}m</td>`;
                tbody.appendChild(row);
            }
        }

        function doUpgrade() {
            let cost = levelCosts[currentLevel];
            if (totalBalance >= cost && currentLevel < 5) {
                totalBalance -= cost; currentLevel++;
                hook.maxDepth = currentLevel * 2000;
                updateUI(); generateShop();
            } else { alert("Insufficient Balance!"); }
        }

        function updateUI() {
            document.getElementById("coins").innerText = totalBalance.toFixed(6);
            document.getElementById("diamonds").innerText = diamonds;
            document.getElementById("energy-text").innerText = energy + "/5";
            document.getElementById("energy-fill").style.width = (energy/5 * 100) + "%";
            
            for(let i=1; i<=3; i++){
                let rem = adSlots[i].limit - adSlots[i].watched;
                document.getElementById(`count-${i}`).innerText = rem;
                if(rem <= 0) {
                    let b = document.getElementById(`btn-slot-${i}`);
                    b.innerText = "LOCKED"; b.classList.add("btn-locked"); b.onclick = null;
                }
            }
            if (energy === 0 && hook.state === 'idle') toggleMenu('adNeeded', true);
        }

        function startAd(type, slotId = null) {
            if(type === 'diamond' && adSlots[slotId].watched >= adSlots[slotId].limit) return;
            
            toggleMenu('adNeeded', false);
            toggleMenu('diamondMenu', false);
            
            const overlay = document.getElementById('ad-overlay');
            const progress = document.getElementById('ad-progress');
            document.getElementById('ad-type-title').innerText = type === 'energy' ? "üé¨ Energy Ad" : "üé¨ Diamond Ad";
            overlay.style.display = 'flex';
            
            let timeLeft = 5;
            let interval = setInterval(() => {
                timeLeft--;
                document.getElementById('ad-timer').innerText = timeLeft;
                progress.style.width = ((5-timeLeft)/5 * 100) + "%";
                if(timeLeft <= 0) {
                    clearInterval(interval);
                    overlay.style.display = 'none';
                    if(type === 'energy') energy = 5;
                    else { diamonds++; adSlots[slotId].watched++; toggleMenu('diamondMenu', true); }
                    updateUI();
                }
            }, 1000);
        }

        function drawRealisticFish(f) {
            ctx.save(); ctx.translate(f.x, f.y);
            if(f.caught) ctx.rotate(Math.PI / 2); else if (f.dir === -1) ctx.scale(-1, 1);
            let fishGrad = ctx.createLinearGradient(-f.w, -f.h, f.w, f.h);
            fishGrad.addColorStop(0, f.color); fishGrad.addColorStop(0.5, "rgba(255,255,255,0.4)"); fishGrad.addColorStop(1, f.color);
            ctx.beginPath(); ctx.fillStyle = fishGrad; ctx.moveTo(-f.w, 0);
            ctx.bezierCurveTo(-f.w, -f.h*1.5, f.w, -f.h*1.5, f.w, 0);
            ctx.bezierCurveTo(f.w, f.h*1.5, -f.w, f.h*1.5, -f.w, 0); ctx.fill();
            ctx.beginPath(); ctx.fillStyle = f.color; ctx.moveTo(-f.w+3, 0);
            ctx.quadraticCurveTo(-f.w-8, -f.h*1.8, -f.w-12, -f.h*2); ctx.quadraticCurveTo(-f.w-6, 0, -f.w-12, f.h*2);
            ctx.quadraticCurveTo(-f.w-8, f.h*1.8, -f.w+3, 0); ctx.fill();
            ctx.beginPath(); ctx.fillStyle = "white"; ctx.arc(f.w*0.6, -f.h*0.3, 1.5, 0, Math.PI*2); ctx.fill();
            ctx.restore();
        }

        function draw() {
            gameTime++;
            let cameraY = (hook.y > canvas.height / 2) ? hook.y - canvas.height / 2 : 0;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            let waterGrad = ctx.createLinearGradient(0, 0, 0, canvas.height);
            waterGrad.addColorStop(0, "#005f73"); waterGrad.addColorStop(1, "#001219");
            ctx.fillStyle = waterGrad; ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.save(); ctx.translate(0, -cameraY);
            reefAssets.forEach(a => {
                if(a.y > cameraY - 200 && a.y < cameraY + canvas.height + 200) {
                    ctx.fillStyle = a.color;
                    if(a.type === 0) { ctx.beginPath(); ctx.arc(a.x, a.y, a.size/2, 0, Math.PI*2); ctx.fill(); }
                    else { ctx.beginPath(); ctx.strokeStyle = a.color; ctx.lineWidth = 4; ctx.moveTo(a.x, a.y); ctx.quadraticCurveTo(a.x + Math.sin(gameTime*0.04+a.x)*12, a.y - a.size, a.x, a.y - a.size*2); ctx.stroke(); }
                }
            });
            ctx.beginPath(); ctx.strokeStyle = "rgba(255,255,255,0.3)"; ctx.setLineDash([10,5]);
            ctx.moveTo(canvas.width/2, -100); ctx.lineTo(hook.x, hook.y-15); ctx.stroke(); ctx.setLineDash([]);
            ctx.strokeStyle = "#eee"; ctx.lineWidth = 3; ctx.beginPath(); ctx.arc(hook.x, hook.y, 12, 0, Math.PI); ctx.stroke();
            
            fishes.forEach((f, index) => {
                if(f.caught) { f.x = hook.x; f.y = hook.y + 15 + (index * 8); }
                else { f.x += f.speed * f.dir; f.y += Math.sin(gameTime * 0.02 + f.y) * 0.2;
                    if(f.x > canvas.width - 30) f.dir = -1; if(f.x < 30) f.dir = 1;
                }
                drawRealisticFish(f);
                if(hook.state === 'retracting' && !f.caught && fishes.filter(ff=>ff.caught).length < currentLevel*4 && Math.hypot(hook.x-f.x, hook.y-f.y) < 20) f.caught = true;
            });
            ctx.restore();

            if(hook.state === 'dropping') { hook.y += hook.speed; if(hook.y > hook.maxDepth) hook.state = 'retracting'; }
            else if(hook.state === 'retracting') { hook.y -= hook.speed; if(hook.y <= 100) { 
                fishes.forEach(f => { if(f.caught) totalBalance += 0.00005; });
                fishes = fishes.filter(f => !f.caught); hook.state = 'idle'; updateUI(); 
            } }

            if(fishes.length < currentLevel * 4) {
                let s = Math.random() * 0.2 + 0.4;
                fishes.push({ x: Math.random()*canvas.width, y: 500+Math.random()*(hook.maxDepth-700), speed: Math.random()*1.5+0.8, dir: Math.random()>0.5?1:-1, caught:false, w:22*s, h:11*s, color:`hsl(${Math.random()*360},65%,50%)` });
            }
            requestAnimationFrame(draw);
        }

        window.addEventListener("mousedown", (e) => { if(e.target.tagName !== 'BUTTON' && hook.state === 'idle' && energy > 0) { energy--; hook.state = 'dropping'; updateUI(); } });
        updateUI(); draw();
    </script>
</body>
</html>

